---
title: "What do people think of democracy? And does it matter?"
output:
  html_document:
    keep_md: yes
    self_contained: no
---
(Warning: A graph-heavy post on public opinion by someone who has never worked with public opinion data before, and who is in addition [very skeptical about the importance of public opinion for large-scale institutional outcomes](http://onlinelibrary.wiley.com/doi/10.1111/1467-9248.12202/abstract). Part of [this occasional series](http://abandonedfootnotes.blogspot.co.nz/search/label/history%20of%20political%20regimes)).

I've been playing around with the data from the latest wave of the [World Values Survey][WVS], trying to figure out what people think of "democracy" in these large-scale surveys, and whether it is related to any large-scale institutional features of political systems. And I must say, I find public opinion about democracy quite puzzling sometimes.

```{r, loadingData, echo=FALSE, warning=FALSE, cache=TRUE, message=FALSE}
library(dplyr)
library(reshape2)


load("../Data/WV6_Data_r_v_2015_04_18.rdata")
countries <- read.csv("Country codes for WVS wave 6.csv")
WVS6_descriptions <- read.csv("WVS6 variable names and descriptions.csv")
variables <-WVS6_descriptions %>% filter(grepl("democr|political sys|elect|human rights|materialist|autonomy index|weight$",LABEL,ignore.case=TRUE))

WV6_Data_v_2015_04_18 <- WV6_Data_v_2015_04_18 %>% 
  mutate(country = plyr::mapvalues(V2, from=countries$V2, to=as.character(countries$country)),
         country_split = plyr::mapvalues(V2A, from=countries$V2, to=as.character(countries$country))) %>% 
  select(V2,V2A,V262,matches(paste(variables$VAR,collapse="|"))) %>%
  mutate(country = plyr::mapvalues(V2, from=countries$V2, to=as.character(countries$country)),
         country_split = plyr::mapvalues(V2A, from=countries$V2, to=as.character(countries$country)),
         year = V262,
         country_year = paste(country,year),
         weight = V258,
         democratic_support_index = (4-V130) - (4-V127 + 4-V128 + 4-V129),
         democratic_support_index = ifelse(V130 < 0 | V127 < 0 | V128 < 0 | V129 < 0,NA,democratic_support_index)) %>%
  select(-V2,-V2A,-V258,-V262)

data_long <- melt(WV6_Data_v_2015_04_18, id.vars=c("country","country_year","year","weight"))

data_long$variable_description <- plyr::mapvalues(data_long$variable, from = variables$VAR, to = paste(variables$VAR,variables$LABEL))
```

It's not that people don't like democracy. On the contrary, public opinion surveys like the [World Values Survey][WVS] or the various regional "Barometer" polls ([Latinobarometer](http://www.latinobarometro.org/lat.jsp), [Arab Barometer](http://www.arabbarometer.org/), [Asian Barometer](http://www.asianbarometer.org/), [Afrobarometer](http://www.afrobarometer.org/)) tend to consistently find that people really like the *idea* of democracy; asking about democracy is like asking about motherhood. Consider the figure below, which plots the range of responses in the sixty countries[^Countries] surveyed by the [WVS][WVS] in its latest iteration to a question asking about people's opinion of "having a democratic political system":

```{r, viewsAboutPoliticalSystems, echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
library(scales)
data <- data_long %>% filter(variable %in% c("V127", "V128","V129","V130")) %>% 
  mutate(value_descriptive = plyr::mapvalues(value,from=c(1,2,3,4,-5,-4,-3,-2,-1), to=c("1: Very good","2: Fairly good","3: Fairly bad","4: Very bad","-5: Missing; RU: Inappropriate response","-4: Not asked in survey","-3: Not applicable","-2: No answer","-1: Don't know")))

data <- data %>% group_by(country_year,variable) %>% count(country_year,variable,variable_description,value_descriptive, total=n(),wt=weight) %>% mutate(percent = n/total)

qplot(data=data %>% filter(!grepl("-5|-4",value_descriptive), grepl("V130",variable_description)),x = value_descriptive,y=percent,geom="boxplot")+theme_bw()+coord_flip() + scale_y_continuous(label=percent) + labs(x="Answers to question",y ="Percent of respondents in each country") + facet_wrap(~variable_description,ncol=1)

```

The pattern is clear enough: in more than half of these countries (including many countries most people would classify as "authoritarian"), at least 40% of the population says that having a democratic system is a "very good" idea, and an additional 30% say it is a "fairly good" idea. In the modal country, in other words, large majorities are "pro-democracy" in some abstract sense. Nevertheless, these same majorities are not always very discriminating about what they consider "good" political systems. In some countries, large numbers of people agree *both* with the idea that democracy is a good form of government, *and* that having the army rule, or having a strong leader "that does not bother with parliament and elections" is *also* a good thing. 

Consider the figure below, which compares answers to the question of whether respondents consider "having a democratic system" a good idea with their answers to questions about other political systems. The figure is ordered according to whether the pattern of responses in a country is similar to that found in New Zealand (the first country at the top left). New Zealand is a good reference country because (besides the fact that I live there) the pattern of belief in NZ is consistently "democratic": democracy is considered to be good by large majorities, while army rule, expert rule, and strong leader rule are not so considered (though expert rule is not altogether discounted).[^Details] Many countries display a similar pattern of responses (not just "Western" countries; see, e.g., Thailand, where democracy is greatly preferred to army rule or expert rule, even if a substantial minority does evaluate these alternatives positively, reflecting Thailand's persistent political conflicts), but in others views are more confusing. For example, majorities of people in India, Mexico, and Egypt seem to think *all* political systems are a great idea; army rule, democracy, expert rule, it's all good.[^Egypt] 

```{r, viewsAboutPoliticalSystemsPerCountry, echo=FALSE, warning=FALSE, message=FALSE, fig.height=30, cache=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
library(scales)
library(cluster)

data <- data_long %>% filter(variable %in% c("V127", "V128","V129","V130")) %>% 
  mutate(value_descriptive = plyr::mapvalues(value,from=c(1,2,3,4,-5,-4,-3,-2,-1), to=c("1: Very good","2: Fairly good","3: Fairly bad","4: Very bad","-5: Missing; RU: Inappropriate response","-4: Not asked in survey","-3: Not applicable","-2: No answer","-1: Don't know")),
         value = as.numeric(value))

#data$value_descriptive <- reorder(data$value_descriptive,4-data$value)
         
data <- data %>% group_by(country_year,variable) %>% mutate(median = median(value[value > 0]*weight[value > 0]),mean = mean(value[value > 0]*weight[value > 0])) %>% count(country_year,variable, value, variable_description, value_descriptive,median,mean, total=n(),wt=weight) %>% mutate(percent = n/total)

data2 <- data %>% ungroup() %>% mutate(variable_value = paste0(variable,value)) %>% select(country_year,variable_value,percent) %>% distinct()

data2 <- dcast(data2, country_year  ~ variable_value)

adjacencyMatrix <- as.matrix(daisy(data2 %>% select(starts_with("V")),metric="gower"))
adjacencyMatrix <- 1 - adjacencyMatrix

dimnames(adjacencyMatrix)[[1]] <- data2$country_year
dimnames(adjacencyMatrix)[[2]] <- data2$country_year

country.similarity <- as.data.frame(adjacencyMatrix)
country.similarity$country_year <- rownames(country.similarity)
data <- left_join(data,country.similarity)

data$country_year <- reorder(data$country_year,-data$`New Zealand 2011`)

library(stringr)
data$variable_description <- str_replace(data$variable_description,"Political system: ","")
data$variable_description <- str_replace(data$variable_description,"for the country","")

qplot(data=data %>% filter(value > 0),x=reorder(strtrim(variable_description,90),median), y=percent,fill=value_descriptive,geom="bar",stat="identity")+theme_bw()+coord_flip() + labs(y ="Percent of responses in each country",x="Question",fill="How good is each political system?") + facet_wrap(~country_year,ncol=3) + scale_fill_brewer(type="div",palette="PuOr") + theme(legend.position="bottom") + guides(fill=guide_legend(direction="horizontal", title.position="top", ncol=2))

```

Indeed, about 36% of all respondents in India give positive evaluations (answers of "very good" or "fairly good") to *all* hypothetical political systems, while less than *1%* of respondents are what we might call "principled democrats," evaluating democracy positively while negatively assessing the remaining options, as we can see in the figure below.[^PrincipledDemocratsFigure] By contrast, around *47%* of respondents of respondents in Sweden are "principled democrats," while only around 4% are what we might call "enthusiasts about everything." (I'm not sure why people in India seem to be so enthusiastic about all the options here; perhaps this is some weird survey artifact. Readers from India might help me out here?)  

```{r, responseTypesPerCountry, echo=FALSE, warning=FALSE, message=FALSE, fig.height=18, cache=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
library(scales)

data <- WV6_Data_v_2015_04_18 %>% select(country_year,V127:V130, weight) %>% mutate(V127 = ifelse(V127 < 0,NA, V127), V128 = ifelse(V128 < 0,NA, V128),V129 = ifelse(V129 < 0,NA, V129), V130 = ifelse(V130 < 0,NA, V130))

data <- data %>% group_by(country_year) %>% count(country_year,dem_positive = ifelse(!is.na(V130),V130<3,NA), strong_leader_positive = ifelse(!is.na(V127),V127<3,NA), expert_positive = ifelse(!is.na(V128),V128<3,NA), army_positive = ifelse(!is.na(V129),V129<3,NA), total=n(), wt=weight) %>% mutate(percent = n/total)
data <- na.omit(data)

data <- data %>% ungroup() %>% mutate(type = paste0(dem_positive,strong_leader_positive,expert_positive,army_positive), 
                        type = plyr::mapvalues(type, from = levels(as.factor(type)), to = c("15: Refusers","9: Army only","8: Expert only","11: Army and expert rule","10: Strong leader only","12: Strong leader and army","13: Strong leader and expert rule","14: General anti-democrats","1: Principled democrats","4: Inconsistent: democracy and army rule","2: Democracy and expert rule", "5: All but strong leader","3: Strong leader democrats","7: All but experts","6: All but army","16: Enthusiasts about everything")))

library(stringr)
data$type <- reorder(data$type, as.numeric(str_extract(data$type,"[0-9]+")))

data <- data %>% group_by(country_year) %>% mutate(percent_pure_democrats = percent[type == "1: Principled democrats"]) %>% arrange(percent_pure_democrats,type)

data <- data %>% group_by(country_year) %>% mutate(cumulative_percent = cumsum(percent) - percent/2)
ggplot(data=data,aes(x=reorder(country_year,percent_pure_democrats), y=percent))+geom_bar(aes(fill=type),stat="identity",color="white")+theme_bw()+coord_flip() + labs(y ="Percent of population",x="Country",fill="Response pattern: positive about what regimes?") + theme(legend.position="bottom") + guides(fill=guide_legend(direction="horizontal", title.position="top",ncol=2))+scale_fill_grey() +scale_y_continuous(label=percent) + geom_text(aes(label=str_extract(type,"[0-9]+"),y=cumulative_percent),color="white",size=2)

```

The [WVS][WVS] also asks a number of questions about whether people consider various things "essential" to democracy, ranging from classic liberal ideas (free elections, equality under the law, civil rights) to economic and social outcomes (the government makes people's outcomes equal), to "antiliberal" ideas ("religious authorities interpret the laws," "army takes over if the government is incompetent"). These answers also display interesting patterns. The figure below is again arranged with New Zealand at the top, followed by those countries whose pattern of responses is most similar:

```{r, viewsAboutDemocracyPerCountry, echo=FALSE, warning=FALSE, message=FALSE, fig.height=30, cache=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
library(scales)
library(cluster)

data <- data_long %>% filter(variable %in% c("V131", "V132","V133","V134","V135","V136","V137","V138","V139")) %>% 
  mutate(value_descriptive = plyr::mapvalues(value,from=c(1,2,3,4,5,6,7,8,9,10,-5,-4,-3,-2,-1), to=c("1: Not essential","2","3","4","5","6","7","8","9","10: Essential", "-5: Missing; RU: Inappropriate response","-4: Not asked in survey","-3: Not applicable","-2: No answer","-1: Don't know")),
         value = as.numeric(value))

data <- data %>% group_by(country_year,variable) %>% mutate(median = median(value[value > 0]*weight[value > 0]),mean = mean(value[value > 0]*weight[value > 0])) %>% count(country_year,variable, value, variable_description, value_descriptive,median,mean, total=n(),wt=weight) %>% mutate(percent = n/total)

data2 <- data %>% ungroup() %>% mutate(variable_value = paste0(variable,value)) %>% select(country_year,variable_value,percent) %>% distinct()

data2 <- dcast(data2, country_year  ~ variable_value)

adjacencyMatrix <- as.matrix(daisy(data2 %>% select(starts_with("V")),metric="gower"))
adjacencyMatrix <- 1 - adjacencyMatrix

dimnames(adjacencyMatrix)[[1]] <- data2$country_year
dimnames(adjacencyMatrix)[[2]] <- data2$country_year

country.similarity <- as.data.frame(adjacencyMatrix)
country.similarity$country_year <- rownames(country.similarity)
data <- left_join(data,country.similarity)

library(stringr)
data$variable_description <- str_replace(data$variable_description,"Democracy: ","")
data$variable_description <- str_replace(data$variable_description,"V[0-9]{3} ","")


data$country_year <- reorder(data$country_year,-data$`New Zealand 2011`)
qplot(data=data %>% filter(value > 0),x=reorder(variable_description,median), y=percent,fill=reorder(value_descriptive,10-value),geom="bar",stat="identity")+theme_bw()+coord_flip() + labs(y ="Percent of responses in each country",x="Question",fill="How essential is this as \na characteristic of democracy?") + facet_wrap(~country_year,ncol=3) + scale_fill_brewer(type="div",palette="PuOr")  + theme(legend.position="bottom") + guides(fill=guide_legend(direction="horizontal", title.position="top", ncol=2))

```

Aggregate conceptions of democracy in the countries at the top of the figure are recognizably "liberal": free elections, women's rights, and civil rights are seen as pretty important to democracy, while economic equality and social security are seen as less important, and "antiliberal" ideas receive little support (though not zero support!). In comparison, aggregate conceptions of democracy in Russia or Kazakhstan (and in most of the post-Communist countries in the sample) tend to emphasize economic equality and social security more (though civil rights and free elections remain important), while in Yemen or Pakistan just about everything in the list is seen as essential to democracy (including antiliberal ideas), and in Bahrain just about everything is seen as unimportant. (The pattern of responses in Bahrain is really puzzling. Any readers who can enlighten me?). 

We can also divide individual responses into different types, depending on how much they emphasize different ideas -- liberal, egalitarian, and antiliberal -- relative to some baseline. This can be done in different ways, but below I simply categorize a response as emphasizing one of these ideas if it scores higher than the world average for the relevant items.[^Mean] We can thus distinguish between relative liberal democrats (people who consider free elections and political rights more important than the median answer in all countries, and egalitarian and antiliberal liberals less so), social democrats (people who associate both liberal and "economic" ideas with democracy), egalitarian democrats (people who associate democracy primarily with "economic" ideas), antiliberals (people who associate democracy primarily with anti-liberal ideas, like "the army takes over when the government is incompetent"), antiegalitarians (people who associate democracy with everything except economic equality), enthusiasts (people who associate democracy with everything), and refusers (people who do not think any of the options on offer in the survey is especially essential). The figure below is ordered according to the percentage of respondents who express relatively liberal and liberal egalitarian views of democracy:

[^Mean]: More precisely, I add up the scores for the three items measuring each of the main ideas, and categorize a response as emphasizing that idea if it this number is larger than average across all countries. "Liberal" ideas are measured by the questions asking about how essential women's rights, free elections, and civil rights are to democracy; "egalitarian" ideas are measured by the questions asking about how essential income equality, state provision of unemployment, and taxation of the rich and subsidies to the poor are to democracy; and "antiliberal" ideas are measured by the questions asking about about how essential obedience to the state, the army taking over if the government is incompetent, and a role for religious authorities interpreting the laws are to democracy. All of these are, of course, highly imperfect as measures of these ideas; but this is in the nature of large-scale survey research.

```{r, responseTypesOnDemocracyPerCountry, echo=FALSE, warning=FALSE, message=FALSE, fig.height=18, cache=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
library(scales)
library(stringr)

data <- WV6_Data_v_2015_04_18 %>% select(country_year,V131:V139, weight) %>% mutate(V131 = ifelse(V131 < 0,NA, V131), V132 = ifelse(V132 < 0,NA, V132),V133 = ifelse(V133 < 0,NA, V133), V134 = ifelse(V134 < 0,NA, V134), V135 = ifelse(V135 < 0,NA, V135), V136 = ifelse(V136 < 0,NA, V136), V137 = ifelse(V137 < 0,NA, V137), V138 = ifelse(V138 < 0,NA, V138), V139 = ifelse(V139 < 0,NA, V139))

data <- data %>% mutate(liberal = V133 + V136 + V139, egalitarian = V134 + V131 + V137, antiliberal = V132 + V139 + V138) %>% group_by(country_year) %>% select(liberal,egalitarian,antiliberal,weight) 

data <- data %>% mutate(country_liberal_mean = weighted.mean(liberal,weight,na.rm=TRUE), country_egalitarian_mean = weighted.mean(egalitarian,weight,na.rm=TRUE), country_antiliberal_mean = weighted.mean(antiliberal,weight,na.rm=TRUE)) %>% ungroup() %>% mutate(liberal_mean = mean(unique(country_liberal_mean),na.rm=TRUE), egalitarian_mean = mean(unique(country_egalitarian_mean),na.rm=TRUE),antiliberal_mean = mean(unique(country_antiliberal_mean),na.rm=TRUE))

data <- data %>% 
  count(country_year, 
        liberal = ifelse(!is.na(liberal),
                         liberal > liberal_mean,NA),
        egalitarian = ifelse(!is.na(egalitarian),
                             egalitarian > egalitarian_mean,NA), 
        antiliberal = ifelse(!is.na(antiliberal),
                             antiliberal > antiliberal_mean,NA),wt=weight) %>% 
  group_by(country_year) %>%
  mutate(total = sum(n),percent = n/sum(n), type = paste0(liberal,egalitarian,antiliberal))

data <- na.omit(data)

data <- data %>% ungroup() %>% mutate(type = plyr::mapvalues(type, from = levels(as.factor(type)), to = c("8: Refusers","5: Antiliberals","3: Egalitarians","4: Egalitarian antiliberals","1: Liberals","6: Antiegalitarians","2: Liberal egalitarians","7: Enthusiasts")))

library(stringr)
data$type <- reorder(data$type, as.numeric(str_extract(data$type,"[0-9]+")))

data <- data %>% group_by(country_year) %>% mutate(percent_liberals = percent[type == "1: Liberals"], percent_all_liberals = sum(percent[type %in% c("1: Liberals","2: Liberal egalitarians")])) %>% arrange(type,percent,percent_all_liberals)

data <- data %>% group_by(country_year) %>% mutate(cumulative_percent = cumsum(percent) - percent/2)

ggplot(data=data,aes(x=reorder(country_year,percent_all_liberals), y=percent))+geom_bar(aes(fill=type),stat="identity",color="white")+theme_bw()+coord_flip() + labs(y ="Percent of population",x="Country",fill="Response pattern: view of democracy") + theme(legend.position="bottom") + guides(fill=guide_legend(direction="horizontal", title.position="top",ncol=2))+scale_fill_brewer(type="div",palette="PuOr") +scale_y_continuous(label=percent) + geom_text(aes(label=str_extract(type,"[0-9]+"),y=cumulative_percent),color="white",size=2)

```

Perhaps unsurprisingly, large numbers of people in "Western" countries -- Germany, Sweden, New Zealand, etc. -- express views of democracy that are "liberal" or "liberal" egalitarian (relative to the world average), though proportions of "principled" liberals and "egalitarian" liberals vary (Germany contains a very large number of "egalitarian" liberals; New Zealand and the United States do not). Overall, however, pure liberal views are relatively uncommon; indeed, in some countries (Bahrain, South Africa) there are basically *no* detectable relative liberals (egalitarian or otherwise), while in many countries (e.g, Qatar, Iraq) large numbers of respondents emphasize both economic equality and anti-liberal ideas. This is not to say that nobody cares about free elections or civil rights; but large numbers of people in many societies appear to see no contradiction between thinking that free elections and civl rights are important to democracy (even if not the most essential thing), and thinking that democracy also involves having a role for religious authorities in politics, or for the army when the elected government appears to fail.

The figure above suggests that aggregate conceptions of democracy may cluster along "cultural" lines. Using a simple graph representation of the similarities between patterns of responses among countries,[^Graph] and a community discovery algorithm, we find between 3 and 7 clusters (depending on the algorithm used), one of which typically corresponds to the "Western" countries plus Japan and South Korea, and another to the Post-socialist world (Soviet countries plus China plus a few others). For example, the figure below displays five clusters, arranged by color according to the average similarity of the conception of democracy of countries in the cluster to New Zealand; the labels in the legend show a representative country in the cluster. 

[^Graph]: A weighted undirected graph where edge strength is the measure of similarity between any two countries in their response patterns to all of the nine questions concerning the essential characteristics of democracy. See the [code][Code] for this post for more detail.

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}
library(dplyr)
library(ggplot2)
library(scales)
library(reshape2)
library(cluster)
library(rworldmap)
library(countrycode)
library(igraph)
library(stringr)

data <- data_long %>% filter(variable %in% c("V131", "V132","V133","V134","V135","V136","V137","V138","V139")) %>% 
  mutate(value = as.numeric(value))

data <- data %>% 
  group_by(country_year,variable) %>% 
  count(country_year,variable, value, total=n(),wt=weight) %>% 
  mutate(percent = n/total)

data <- data %>% ungroup() %>% mutate(variable_value = paste0(variable,value)) %>% select(country_year,variable_value,percent) %>% distinct()

data <- dcast(data, country_year  ~ variable_value)

adjacencyMatrix <- as.matrix(daisy(data %>% select(starts_with("V")),metric="gower"))
adjacencyMatrix <- 1 - adjacencyMatrix

dimnames(adjacencyMatrix)[[1]] <- data$country_year
dimnames(adjacencyMatrix)[[2]] <- data$country_year

g <- graph.adjacency(adjacencyMatrix, weighted=TRUE, mode="undirected")
group <- optimal.community(g)
group <- as.data.frame(membership(group))
group$country <-  countrycode(rownames(group),origin="country.name",destination="country.name",warn=TRUE)
# group$year <- as.numeric(str_extract(rownames(group),"[0-9]{4}"))
# group <- left_join(group,fh)
# group <- cbind(group,ggmap::geocode(paste0("country:",plyr::mapvalues(group$country,from="Korea, Republic of",to="South Korea"))))

adjacencyMatrix <- as.data.frame(adjacencyMatrix)
adjacencyMatrix$country <- countrycode(rownames(adjacencyMatrix),origin="country.name",destination="country.name",warn=TRUE)
group <- left_join(group,adjacencyMatrix)
group <- group %>% group_by(`membership(group)`) %>% arrange(desc(`New Zealand 2011`)) %>% mutate(avg_NZ_sim = mean(`New Zealand 2011`), group_name = first(country))


world <- getMap()
world <- fortify(world)
world$id <- countrycode(world$id, origin="country.name",destination="country.name",warn=TRUE)

ggplot()+ geom_map(aes(fill=reorder(group_name,avg_NZ_sim),map_id=country,alpha=`New Zealand 2011`),map=world,data=group)+geom_path(data=world,aes(y=lat,x=long,group=group)) + theme_bw() + theme(legend.position="bottom") + labs(fill="Group",x="",y="", alpha="Degree of similarity to New Zealand's conception of democracy")+guides(fill=guide_legend(title.position="top")) + scale_fill_brewer(type="div",palette="RdYlBu") 

```

The countries in the dark blue group ("New Zealand") show "liberal" patterns of responses, and contain most of the "Western"" democracies, plus Japan, South Korea, and Uruguay. The countries in the orange ("Russia") group contain most of the post-socialist countries, plus a few others (Egypt, Malaysia). Countries in light blue comprise an "Iberoamerican" cluster (Spain plus Argentina and Chile) that is pretty similar to the "Westerne Europe" cluster; countries in dark red are pretty similar to the post-socialist countries, though they tend to have more "illiberal" conceptions of democracy. One could easily tell a story here about how socialization in formerly communist countries tended to associate democracy with "socialist democracy" and the egalitarian values of the socialist project, values that, though denied in practice in some ways, seem to have been accepted by the vast majority of the population. And a contrasting story could be told about the "Western" conception of democracy, which more strictly separates egalitarian "outcomes" from democracy as such. I am less sure about the other, more illiberal clusters; I suppose one could tell a story about the importance of "religious authority" in some of them, but it certainly would not fit all countries. Perhaps the most obvious feature of the "Cyprus" (light yellow) and "Peru" (dark red) clusters is that they seem to gather many the countries of what was formerly called the "third world," which suggests a better division into "first," "second," and "third" world conceptions of democracy.

One might also ask about the correlation between these conceptions of democracy and "actual" measures of democracy. Is a certain set of values normally associated -- or even contributes to the development of -- standardly democratic institutions? [Ronald Inglehart][Inglehart] (one of the principal investigators for the [WVS][WVS]) has argued that the number of people who "like" democracy or find it important for their country is essentially uncorrelated with standard measures of democracy (he uses [Freedom House][FH], but the point holds for other measures, like [Polity IV][Polity]). Talk is cheap, and "liking" democracy has little to do with "having" a standardly democratic political system. Instead, he suggests, democracy is associated with what he and his collaborators call "post-materialist" values. 

Inglehart is certainly right about the lack of correlation between "liking" democracy (or even considering it important) and standard measures of democracy (as we can see below); but though the measures of post-materialism included with the [WVS][WVS] do show some correlation with standard measures of democracy, this is not always very high. Interestingly, however, the percentage of people who give "liberal" answers to questions about the essential characteristics of democracy (relative to the world average) displays a higher correlation with "standard" measures of democracy than almost anything else:

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}
library(dplyr)
library(countrycode)
library(foreign)
library(ggplot2)

fh <- read.csv("../Data/fh.19722014.csv") # Jay Ulfelder's CSV version of the FH scores to 2014 is available here: https://drive.google.com/file/d/0B5wyt4eDq98GZVhUamRKVXJpLVU/view?usp=sharing  
fh <- na.omit(fh)

polity <- read.spss("http://www.systemicpeace.org/inscr/p4v2014.sav",to.data.frame=TRUE)
polity <- select(polity, country, year, polity2)
polity <- na.omit(polity)

fh <- fh %>% mutate(country = countrycode(country,"country.name","country.name")) %>% group_by(country) %>% mutate(cumpr = cumsum(pr),cumcl = cumsum(cl), total_fh = pr+cl, total_fh_reversed = 14 - (pr + cl), fh_cumulative_reversed = cumsum(total_fh_reversed))

polity <- polity %>% mutate(country = countrycode(country,"country.name","country.name")) %>% group_by(country) %>% mutate(polity_cumulative2 = cumsum(polity2))

data <- WV6_Data_v_2015_04_18 %>% select(country_year,V127:V140, starts_with("Y"),weight) %>% mutate(V127 = ifelse(V127 < 0,NA, V127),V128 = ifelse(V128 < 0,NA, V128),V129 = ifelse(V129 < 0,NA, V129),V130 = ifelse(V130 < 0,NA, V130),V131 = ifelse(V131 < 0,NA, V131), V132 = ifelse(V132 < 0,NA, V132),V133 = ifelse(V133 < 0,NA, V133), V134 = ifelse(V134 < 0,NA, V134), V135 = ifelse(V135 < 0,NA, V135), V136 = ifelse(V136 < 0,NA, V136), V137 = ifelse(V137 < 0,NA, V137), V138 = ifelse(V138 < 0,NA, V138), V139 = ifelse(V139 < 0,NA, V139), V140 = ifelse(V140 < 0,NA, V140), Y001 = ifelse(Y001 < 0,NA, Y001), Y002 = ifelse(Y002 < 0,NA, Y002), Y003 = ifelse(Y003 < 0,NA, Y003))

data <- data %>% mutate(liberal = V133 + V136 + V139, egalitarian = V134 + V131 + V137, antiliberal = V132 + V139 + V138, democrat = ifelse(V130 <=2 & !is.na(V130),TRUE,FALSE), pure_democrat = ifelse(V127 > 2 & V128 > 2 & V129 > 2 & V130 <=2 & !is.na(V127)  & !is.na(V128)  & !is.na(V129) & !is.na(V130),TRUE,FALSE)) %>% group_by(country_year) %>% select(liberal,egalitarian,antiliberal,democrat,pure_democrat,V140,Y001,Y002,Y003,weight) 

percent_democrats <- data %>% group_by(country_year) %>% count(country_year,total=n(),democrat,wt=weight) %>% mutate(percent_democrats=n/total) %>% filter(democrat) %>% ungroup() %>% select(country_year,percent_democrats)

percent_pure_democrats <- data %>% group_by(country_year) %>% count(country_year,total=n(),pure_democrat,wt=weight) %>% mutate(percent_pure_democrats=n/total) %>% filter(pure_democrat) %>% ungroup() %>% select(country_year,percent_pure_democrats)

liberals <- data %>% mutate(country_liberal_mean = weighted.mean(liberal,weight,na.rm=TRUE), country_egalitarian_mean = weighted.mean(egalitarian,weight,na.rm=TRUE), country_antiliberal_mean = weighted.mean(antiliberal,weight,na.rm=TRUE)) %>% ungroup() %>% mutate(liberal_mean = mean(unique(country_liberal_mean),na.rm=TRUE), egalitarian_mean = mean(unique(country_egalitarian_mean),na.rm=TRUE),antiliberal_mean = mean(unique(country_antiliberal_mean),na.rm=TRUE))

liberals <- liberals %>% 
  count(country_year, 
        liberal = ifelse(!is.na(liberal),
                         liberal > liberal_mean,NA),
        egalitarian = ifelse(!is.na(egalitarian),
                             egalitarian > egalitarian_mean,NA), 
        antiliberal = ifelse(!is.na(antiliberal),
                             antiliberal > antiliberal_mean,NA),wt=weight) %>% 
  group_by(country_year) %>%
  mutate(total = sum(n),percent = n/sum(n), type = paste0(liberal,egalitarian,antiliberal))

liberals <- na.omit(liberals)

liberals <- liberals %>% ungroup() %>% mutate(type = plyr::mapvalues(type, from = levels(as.factor(type)), to = c("8: Refusers","5: Antiliberals","3: Egalitarians","4: Egalitarian antiliberals","1: Liberals","6: Antiegalitarians","2: Liberal egalitarians","7: Enthusiasts")))

liberals <- liberals %>% group_by(country_year) %>% mutate(percent_liberals = percent[type == "1: Liberals"], percent_all_liberals = sum(percent[type %in% c("1: Liberals","2: Liberal egalitarians")])) %>% select(percent_liberals, percent_all_liberals) %>% distinct()

indexes <- data %>% group_by(country_year) %>% summarise(avg_importance_dem = weighted.mean(V140,weight, na.rm=TRUE), avg_post_materialism12 = weighted.mean(Y001,weight, na.rm=TRUE),avg_post_materialism4 = weighted.mean(Y002,weight, na.rm=TRUE), avg_autonomy = weighted.mean(Y003,weight, na.rm=TRUE))

data <- left_join(indexes, percent_democrats)
data <- left_join(data, percent_pure_democrats)
data <- left_join(data, liberals)

rm(indexes,percent_democrats,percent_pure_democrats,liberals)

data <- data %>% mutate(country = countrycode(country_year,origin="country.name",destination="country.name",warn=TRUE), year = as.numeric(str_extract(country_year,"[0-9]{4}")))

data <- left_join(data,fh) 
data <- left_join(data,polity)

qplot(data = data, x= total_fh_reversed, y = percent_liberals) + geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Freedom House score (PR+CL), reversed, at time of survey", y="Percent liberals") + theme_bw() + scale_y_continuous(label=percent)

qplot(data=data,x=fh_cumulative_reversed,y=percent_liberals)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Cumulative Freedom House score (PR+CL), reversed", y="Percent liberals") + theme_bw() + scale_y_continuous(label=percent)

qplot(data=data,x=fh_cumulative_reversed,y=percent_all_liberals)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Cumulative Freedom House score (PR+CL), reversed", y="Percent liberals + liberal egalitarians") + theme_bw() + scale_y_continuous(label=percent)

qplot(data=data,x=fh_cumulative_reversed,y=avg_post_materialism4)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Cumulative Freedom House score (PR+CL), reversed", y="Avg. materialist/post-materialist index (4 items), Inglehart") + theme_bw() 

qplot(data=data,x=fh_cumulative_reversed,y=avg_importance_dem)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Cumulative Freedom House score (PR+CL), reversed", y="Avg. answer to question V140: \nimportance of country being governed democratically") + theme_bw() 

correlations <- as.data.frame(round(cor(data %>% select(-starts_with("country"),-year,-dosreg,-yrborn,-yrdied,-sftgcode,-cl,-pr,-cumcl,-cumpr,-total_fh,-contains("polity"),-contains("fh")),data %>% select(contains("fh"),contains("polity"),-total_fh),use="pairwise.complete"),1)) 

names(correlations) <- c("Current FH score, reversed","Cumulative reversed FH score","Current Polity2","Cumulative Polity2")
rownames(correlations) <- c("Avg answer for V140: importance of democracy","Avg post-materialism index (12 items)", "Avg post-materialism index (4 items)","Avg autonomy index", "% people who think democracy is good","% people who think only democracy is good","% relative liberals","% liberals plus liberal egalitarians")
correlations
```

I do not think this says much about whether a certain combination of values is needed to produce or sustain democracy; more likely, the process of socialization in countries with "consolidated" liberal democratic institutions, like New Zealand, more clearly differentiates "democracy" from other alternatives, and more clearly associates it with a specific constellation of institutions, while elsewhere the word might come to be filled with all kinds of additional aspirations, depending partly on the dominant ideological themes of the regime. In other words, I find it more plausible that liberal democratic institutions tend to produce liberal democrats than the reverse. And I do not find Inglehart *et al.*'s argument for the importance of post-materialist values to the long-run stability of democracy convincing; though there is certainly a correlation between these post-materialism indexes and some measures of democracy (not all), some [careful statistical work](http://dx.doi.org/10.1007/BF02686166) suggests the relationship goes away when using other measures of democracy and accounting for reverse causation (from institutions to values). 

The [World Values Survey][WVS] also asks some questions about what people think of the actual *degree* of democracy in their country. Some are general questions -- how democratic would you say your country is? -- while others are more specific -- e.g., about whether the opposition has a chance to compete in elections. One interesting thing about the responses to these questions are not highly correlated with "standard" measures of democracy; the expert and popular crowds often diverge, sometimes radically, about these assessments:

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}
library(dplyr)
library(countrycode)
library(ggplot2)

data <- WV6_Data_v_2015_04_18 %>% select(country_year,V140:V142, V228A:V228K, weight)
data <- data %>% mutate(V140 = ifelse(V140 < 0,NA, V140),V141 = ifelse(V141 < 0,NA, V141),V142 = ifelse(V142 < 0,NA, V142),V228A = ifelse(V228A < 0,NA, V228A),V228B = ifelse(V228B < 0,NA, V228B),V228C = ifelse(V228C < 0,NA, V228C),V228D = ifelse(V228D < 0,NA, V228D),V228E = ifelse(V228E < 0,NA, V228E),V228E = ifelse(V228E < 0,NA, V228E),V228F = ifelse(V228F < 0,NA, V228F),V228G = ifelse(V228G < 0,NA, V228G),V228H = ifelse(V228H < 0,NA, V228H),V228I = ifelse(V228I < 0,NA, V228I),V228J = ifelse(V228J < 0,NA, V228J),V228K = ifelse(V228K < 0,NA, V228K), elections_index = 5- V228A + V228B + V228C + V228D + 5 - V228E + 5 - V228F + V228G + V228H + 5 - V228I)

importance <- data %>% group_by(country_year) %>% summarise(mean_importance = weighted.mean(V140,weight,na.rm=TRUE))
democratic_rating <- data %>% group_by(country_year) %>% summarise(mean_rating = weighted.mean(V141,weight,na.rm=TRUE))
human_rights <- data %>% group_by(country_year) %>% summarise(mean_human_rights = weighted.mean(V142,weight,na.rm=TRUE))
avg_elections <- data %>% group_by(country_year) %>% summarise(mean_elections = weighted.mean(elections_index,weight,na.rm=TRUE))
# importance_elections_private <- data %>% group_by(country_year) %>% summarise(mean_importance_elections_private = weighted.mean(V228J,weight,na.rm=TRUE))
# importance_elections_public <- data %>% group_by(country_year) %>% summarise(mean_importance_elections_public = weighted.mean(V228K,weight,na.rm=TRUE))

data <- left_join(importance, democratic_rating)
data <- left_join(data, human_rights)
data <- left_join(data, avg_elections)

rm(importance,democratic_rating,human_rights,avg_elections)

data <- data %>% mutate(country = countrycode(country_year,origin="country.name",destination="country.name",warn=TRUE), year = as.numeric(str_extract(country_year,"[0-9]{4}")))

data <- left_join(data,fh) 
data <- left_join(data,polity)



qplot(data=data,x=total_fh_reversed,y=mean_rating)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Freedom House score (PR+CL), reversed, year of survey", y="Avg. answer to V141: \nHow democratic is this country being governed today? (0-10)") + theme_bw() 

qplot(data=data,x=polity2,y=mean_rating)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Polity2 score, year of survey", y="Avg. answer to V141: \nHow democratic is this country being governed today? (0-10)") + theme_bw() 

qplot(data=data,x=cl,y=mean_human_rights)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Freedom House Civil Rights score, year of survey (higher is worse)", y="Avg. answer to V142: \nHow much respect is there for individual human rights nowadays in this country? \n(1-4, lower is more respect)") + theme_bw() 

qplot(data=data,x=total_fh_reversed,y=mean_elections)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Freedom House score (PR+CL), reversed, year of survey", y="Avg. index of election integrity \n(calculated from answers to V228A to V228I) \n(higher means more positive perceptions of elections)") + theme_bw() 

qplot(data=data,x=mean_importance,y=mean_rating)+geom_smooth() + geom_text(aes(label=country_year), size=2) + labs(x="Avg. answer to V140: \nHow important is it that this country be governed democratically? (0-10)", y="Avg. answer to V141: \nHow democratic is this country being governed today? (0-10)") + theme_bw()

correlations <- as.data.frame(round(cor(data %>% select(starts_with("mean")),data %>% select(pr,cl,total_fh_reversed,polity2),use="pairwise.complete"),2))
names(correlations) <- c("FH Political Rights","FH Civil Rights","Total FH, reversed","Polity2")
rownames(correlations) <- c("Avg importance of democracy","Avg rating of current level of democracy","Avg rating of human rights protection","Avg index of election integrity")
correlations

```

These differences are not altogether surprising; different people will answer "rating" questions like these from different baselines, and their responses may anyway be affected by such factors as how well they think the country is doing, what political events are in the news, and perhaps even their mood or the weather at the time of the interview. Someone with more time and training than me could probably figure out how to calibrate these responses better. Yet there are still some interesting patterns worth noticing. For example, there seems to be something of a "sour grapes" effect: in some countries where people rate the level of democracy lower, they also tend to give lower average answers to the question of how important it is that their country be ruled democratically. Also, answers about elections in less democratic countries (by standard measures) tend to be reasonably well correlated with measures of democracy; people in Rwanda, for example, are surprisingly upbeat when they answer the question of how democratically they think their country is ruled (perhaps due to the successes of Rwandan economic development under Kagame), but (on the aggregate at least) they are under few illusions about their electoral process, which they accurately judge are hardly models of fairness. The one obvious outlier is Singapore, where people express great confidence in the freedom and fairness of their elections while being given a low FH/Polity2 score. 

The specific answers to questions about elections are interesting in themselves (it's too bad it was only asked in 40 out of the 60 countries in this wave of the [WVS][WVS]). The figure below is arranged from "freest" to "least free" (by the total [Freedom House][FH] score), starting with Australia and Chile:

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE,fig.height=30}
library(dplyr)
library(countrycode)
library(ggplot2)
library(stringr)
library(scales)

data <- data_long %>% filter(grepl("V228[A-I]",variable))
data <- data %>% mutate(value = as.numeric(value), value = ifelse(value < 0, NA, value), value_descriptive = plyr::mapvalues(value,from=c(1,2,3,4), to=c("1: Very often","2: Fairly often","3: Not often","4: Not at all often")))

data <- data %>% group_by(country_year,variable) %>% count(country_year,variable,variable_description,value,value_descriptive,total=n(),wt=weight) %>% mutate(percent = n/total)

data <- data %>% mutate(country = countrycode(country_year,origin="country.name",destination="country.name",warn=TRUE), year = as.numeric(str_extract(country_year,"[0-9]{4}")))

data <- left_join(data,fh)

data$variable_description <- str_replace(data$variable_description,"V228[A-I] How often in country's elections: ","")
data$country_year <- reorder(data$country_year,desc(data$total_fh_reversed))
data <- na.omit(data)

ggplot(data = data, aes(x = variable_description, y = percent, fill=value_descriptive)) + geom_bar(stat="identity") + theme_bw()+ facet_wrap( ~ country_year,ncol=3) + theme(legend.position="bottom") + guides(fill=guide_legend(title.position="top",ncol=2)) + labs(x="Election question",y="Percent of respondents",fill = "Response") + scale_y_continuous(labels=percent)+coord_flip() + scale_fill_brewer(type="div",palette="PuOr")

```

Countries at the very top display high levels of trust in elections: most people think votes are counted fairly, election officials are fair, voters are given a genuine choice at the polls, opposition politicians are not prevented from running, there's little violence at the polls, and media coverage is reasonably unbiased. (The Netherlands is the model country here; the Dutch really trust in their electoral process!). As we go down the list, however, we find countries where trust in the voting process is mingled with distrust at the media and the rich (e.g., Taiwan and Brazil), and eventually countries where opinion is highly polarized (e.g., Pakistan, Zimbabwe, Egypt, or Nigeria, where significant numbers think votes are counted fairly and significant numbers think they aren't). Only in a few countries (perhaps Yemen in 2014 or Ukraine in 2011?) do we find something like a generalized distrust of the electoral process by majorities of those surveyed; more usually, different groups in the population fiercely disagree about the fairness of the electoral process (as in Venezuela today -- unfortunately not included in this WVS wave).This is one more reason to think that elections do not necessarily "legitimate" governments; if half your population strongly doubts their fairness, and the other half strongly supports it, the election is going to be experienced quite differently by each side.

The nine items on elections measure, as far as I can tell, measure four dimensions of the electoral process: fairness of the election itself (electoral officials are fair, votes are counted fairly, voters are threatened with violence at the polls); fairness of the media (TV news coverage, journalists); extent of choice (voters are offered a genuine choice, opposition politicians are prevented from running); and interference by the wealthy (voters are bribed, rich people buy elections). We can thus group individual responses according to trust in each of these components:

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE,fig.height=30}
library(dplyr)
library(countrycode)
library(ggplot2)
library(stringr)
library(scales)

data <- data_long %>% filter(grepl("V228[A-I]",variable))
data <- data %>% mutate(value = as.numeric(value), value = ifelse(value < 0, NA, value), value_descriptive = plyr::mapvalues(value,from=c(1,2,3,4), to=c("1: Very often","2: Fairly often","3: Not often","4: Not at all often")))

data <- data %>% group_by(country_year,variable) %>% count(country_year,variable,variable_description,value,value_descriptive,total=n(),wt=weight) %>% mutate(percent = n/total)

data <- data %>% mutate(country = countrycode(country_year,origin="country.name",destination="country.name",warn=TRUE), year = as.numeric(str_extract(country_year,"[0-9]{4}")))

data <- left_join(data,fh)

data$variable_description <- str_replace(data$variable_description,"V228[A-I] How often in country's elections: ","")
data$country_year <- reorder(data$country_year,desc(data$total_fh_reversed))
data <- na.omit(data)

ggplot(data = data, aes(x = variable_description, y = percent, fill=value_descriptive)) + geom_bar(stat="identity") + theme_bw()+ facet_wrap( ~ country_year,ncol=3) + theme(legend.position="bottom") + guides(fill=guide_legend(title.position="top",ncol=2)) + labs(x="Election question",y="Percent of respondents",fill = "Response") + scale_y_continuous(labels=percent)+coord_flip() + scale_fill_brewer(type="div",palette="PuOr")

```


All code for the figures in this post is available [in this GitHub repository][Code]. You will also need the [World Values Survey][WVS] data file (sixth wave, 2011-2014), and the latest data from Freedom House (helpfully converted into an R-friendly [CSV file](https://drive.google.com/file/d/0B5wyt4eDq98GZVhUamRKVXJpLVU/view?usp=sharing) by [Jay Ulfelder](https://dartthrowingchimp.wordpress.com/) [here](https://drive.google.com/file/d/0B5wyt4eDq98GZVhUamRKVXJpLVU/view?usp=sharing)).

[^Countries]: Not all questions were asked in every country. The countries surveyed were Algeria (2013), Argentina (2013), Armenia (2011), Australia (2012), Azerbaijan (2011), Bahrain (2014), Belarus (2011), Brazil (2014), Chile (2011), China (2012) , Colombia (2012), Cyprus (Greek side only, 2011), Ecuador (2013), Egypt (2013), Estonia (2011), Georgia (2014), Germany (2013), Ghana (2012), Hong Kong (2013), India (2014), Iraq (2012), Japan (2010), Jordan (2014), Kazakhstan (2011), Kuwait (2014), Kyrgyzstan (2011), Lebanon (2013), Libya (2014), Malaysia (2012), Mexico (2012), Morocco (2011), Netherlands (2012), New Zealand (2011), Nigeria (2011), Pakistan (2012), Palestine (2013), Peru (2012), Philippines (2012), Poland (2012), Qatar (2010), Romania (2012), Russia (2011), Rwanda (2012), Singapore (2012), Slovenia (2011), South Africa (2013), South Korea (2010), Spain (2011), Sweden (2011), Taiwan (2012), Thailand (2013), Trinidad and Tobago (2011), Tunisia (2013), Turkey (2011), Ukraine (2011), United States (2011), Uruguay (2011), Uzbekistan (2011), Yemen (2014), and Zimbabwe (2012).  

[^Details]: For the details of how the measure of similarity was calculated, take a look at the [code for this post][Code]. Essentially, I created a matrix of the proportions of the population giving each answer in each country, and used a Gower distance measure to calculate which countries were similar to which. 

[^PrincipledDemocratsFigure]: The figure excludes Egypt, Morocco, and Qatar, where some of these questions weren't asked. There's a fair amount of non-response to these questions in many countries; that's the reason why the bars in the figure don't go all the way to the right hand side.

[^FHScores]:  This is in the expected direction; lower FH scores are "more democratic" or "freer." I use Freedom House scores because they are available up to 2014, and they encode a relatively "thick" idea of *liberal* democracy; my first choice would normally have been to use the [Unified Democracy Scores][UDS].

[^Egypt]: Egyptians weren't asked about army rule in 2013. Perhaps the question was regarded as too politically sensitive in the circumstances. 

[WVS]: http://www.worldvaluessurvey.org/wvs.jsp
[FH]: http://freedomhouse.org/
[Code]: https://github.com/xmarquez/WorldValuesSurvey
[Polity]: http://www.systemicpeace.org/inscrdata.html
[UDS]: http://www.unified-democracy-scores.org/
[Inglehart]: http://folk.uio.no/berasch/Inglehart-PS.pdf